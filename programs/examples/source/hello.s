; HELLO.S
; THE CLASSIC "HELLO WORLD" PROGRAM
; GAVIN TERSTEEG, 2024
; SDMAY24-14

; DEFINES
UART	=	0X90
UART_TH	=	UART+0X00
UART_LS	=	UART+0X05

.TEXT
	; START HERE
	; LET B BE OUR STRING POINTER 
START:	LOADI	B,STRING

	; LOAD STRING CHARACTER
PRINT:	LOADF	A,[B]

	; MAKE SURE IT ISNT ZERO
	ADDI	A,0
	BRZ	END
	
	; GET LINE STATUS REGISTER
WAIT:	LOAD	C,[UART_LS]
	
	; READ 5TH BIT TO SEE IF WE CAN TRANSMIT YET
	SHIFTL	C
	SHIFTL	C
	SHIFTL	C
	BRNC	WAIT
	
	; TRANSMIT BYTE
	STORE	[UART_TH],A
	
	; INCREMENT POINTER
	ADDI	B,1
	
	; RETURN TO PRINT LOOP
	JUMP	PRINT
	
	; AND HALT...
END:	JUMP	END
	


.DATA
.DEFL BYTE STRING	0x0A,0X0D,"HELLO, WORLD!",0X0A,0x0D,0
	