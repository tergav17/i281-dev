00/00:          ; DOSDEF.S
01/80:          ; THIS FILE CONTAINS IMPORTANT DEFINES USED IN DOS/281
01/80:          
01/80:          ; BIOS CALLS
01/80:          REBOOT	= 0
01/80:          AREBOOT = 1
01/80:          INDIR	= 2
01/80:          IRET	= 3
01/80:          SYSCALL	= 4
01/80:          SYSJUMP	= 5
01/80:          PRGM	= 6
01/80:          IWRITE	= 7
01/80:          ZSTART	= 8
01/80:          
01/80:          HALT	= 0X7F
01/80:          
01/80:          ; SYSTEM CALLS
01/80:          S_EXIT	= 0
01/80:          S_PUTC	= 1
01/80:          S_GETC	= 2
01/80:          S_STAT	= 3
01/80:          S_PUTS	= 4
01/80:          S_INPUT	= 5
01/80:          S_OPEN	= 6
01/80:          S_CLOSE	= 7
01/80:          S_READ	= 8
01/80:          S_WRITE	= 9
01/80:          S_FSRCH	= 10
01/80:          S_NEXT	= 11
01/80:          S_DELET	= 12
01/80:          S_CREAT	= 13
01/80:          S_FREE	= 14
01/80:          S_EXEC	= 15
01/80:          
01/80:          ; MEMORY AREAS
01/80:          CF_NAME	= 0X60
01/80:          CF_SIZE	= 0X68
01/80:          CF_USR	= 0X6A
01/80:          DFT_USR	= 0X6B
01/80:          ARG_BNK	= 0X6C
01/80:          BD_FREE	= 0X6E
01/80:          MAX_IB	= 0X70
01/80:          MAX_DB	= 0X71
01/80:          CMDL_B	= 0X72
01/80:          AUTO_B	= 0X73
01/80:          KERNMEM	= 0X78
01/80:          BIOSMEM	= 0X7C
01/80:          
01/80:          ; DATA BANK ADDRESS
01/80:          DBANK	= 0X80		
01/80:          
01/80:          ; XMODEM.S
01/80:          ; SEND OR RECIEVE A FILE VIA XMODEM
01/80:          
01/80:          ; BUFFER WILL START AT BANK 2
01/80:          BUFFER	= 2
01/80:          
01/80:          ; BANK ALLOCATION STUFF
01/80:          BI	= 1
01/80:          BD	= 1
01/80:          
01/80:          ; MAXIMUM ARGUMENTS
01/80:          MAXARGS	= 1
01/80:          
01/80:          .TEXT
01/80:          .BANK	BI
01/80:          CORE0_B	= BI
01/80:          
01/80:          	; START BY PROCESSING THE ARGUMENTS
01/80: 3000     START:	LOADI	A,0
01/81: A080     	STORE	[DBANK],A
01/83:          	
01/82:          	; RESET ARG STATE
01/82: A003     	STORE	[SFLAG],A
01/83: A004     	STORE	[TFLAG],A
01/84: A000     	STORE	[ARGC],A
01/86:          	
01/85:          	; SET UP STACK
01/85: 3C5E     	LOADI	D,0X60-2
01/87:          	
01/86:          	; SYSCALL RETURN BANK
01/86: 3801     	LOADI	C,1	
01/87: BB01     	STOREF	[D+1],C
01/89:          	
01/88:          	; SET UP POINTER
01/88: 3800     	LOADI	C,0
01/8A:          	
01/89:          	; GO TO ARGUMENT BANK
01/89: 8072     0:	LOAD	A,[CMDL_B]
01/8A: A06C     	STORE	[ARG_BNK],A
01/8B: A080     	STORE	[DBANK],A
01/8D:          
01/8C:          	; SKIP THE CURRENT ARGUMENT
01/8C: 9200     1:	LOADF	A,[C]
01/8D: 3420     	LOADI	B,0X20
01/8E: D100     	CMP	A,B
01/8F: F902     	BRBE	2F
01/90: 5801     	ADDI	C,1
01/91: FFFA     	JUMP	1B
01/93:          
01/92:          	; LOOK FOR AN ARGUMENT
01/92: 9200     2:	LOADF	A,[C]
01/93: 5000     	ADDI	A,0
01/94: F631     	BRZ	ARGDONE
01/95: D100     	CMP	A,B
01/96: F802     	BRA	3F
01/97: 5801     	ADDI	C,1
01/98: FFF9     	JUMP	2B
01/9A:          
01/99:          	; IS IT A FLAG?
01/99: 342D     3:	LOADI	B,'-'
01/9A: D100     	CMP	A,B
01/9B: F717     	BRNZ	5F
01/9D:          	
01/9C:          	; HANDLE FLAGS HERE	
01/9C: 5801     4:	ADDI	C,1
01/9D: 9200     	LOADF	A,[C]
01/9E: 5000     	ADDI	A,0
01/9F: F626     	BRZ	ARGDONE
01/A0: 3420     	LOADI	B,0X20
01/A1: D100     	CMP	A,B
01/A2: F9EF     	BRBE	2B
01/A4:          	
01/A3:          	; REGISTER THE FLAG
01/A3: 3400     	LOADI	B,0
01/A4: A480     	STORE	[DBANK],B
01/A6:          
01/A5: 7053     	SUBI	A,'S'
01/A6: F701     	BRNZ	@+2
01/A7: 3403     	LOADI	B,SFLAG
01/A8: 7001     	SUBI	A,'T'-'S'
01/A9: F701     	BRNZ	@+2
01/AA: 3404     	LOADI	B,TFLAG
01/AC:          	
01/AB:          	; IS IT A RECOGNIZED FLAG?
01/AB: 5400     	ADDI	B,0
01/AC: F60F     	BRZ	ARGBAD
01/AD: 3001     	LOADI	A,1
01/AE: B100     	STOREF	[B],A
01/B0:          
01/AF:          	; THERE MAY BE ANOTHER FLAG
01/AF: 8472     	LOAD	B,[CMDL_B]
01/B0: A46C     	STORE	[ARG_BNK],B
01/B1: A480     	STORE	[DBANK],B
01/B2: FFE9     	JUMP	4B
01/B4:          
01/B3:          	; SAVE THE ARGUMENT
01/B3: 3400     5:	LOADI	B,0
01/B4: A480     	STORE	[DBANK],B
01/B5: 8400     	LOAD	B,[ARGC]
01/B6: B901     	STOREF	[B+ARGV],C
01/B8:          	
01/B7:          	; DID WE EXCEED THE ALLOWED NUMBER OF ARGUMENTS
01/B7: 7401     	SUBI	B,MAXARGS
01/B8: F003     	BRC	ARGBAD
01/B9: 5402     	ADDI	B,MAXARGS+1
01/BA: A400     	STORE	[ARGC],B
01/BB: FFCD     	JUMP	0B
01/BD:          	
01/BC:          	; BAD ARGUMENT
01/BC: 3000     ARGBAD:	LOADI	A,0
01/BD: A080     	STORE	[DBANK],A
01/BF:          	
01/BE: 3001     	LOADI	A,STR_B
01/BF: A06C     	STORE	[ARG_BNK],A
01/C0: 3000     	LOADI	A,ERROR0
01/C2:          	
01/C1:          	; PRINT ERROR MESSAGE
01/C1: 3404     	LOADI	B,S_PUTS
01/C2: 38C4     	LOADI	C,EXIT
01/C3: FF40     	JUMP	SYSCALL	
01/C5:          
01/C4:          	; EXIT PROGRAM
01/C4: 3400     EXIT:	LOADI	B,0
01/C5: FF3F     	JUMP	SYSJUMP
01/C7:          	
01/C6:          	; ARGUMENT PROCESSING DONE
01/C6: 3000     ARGDONE:LOADI	A,0
01/C7: A080     	STORE	[DBANK],A
01/C9:          	
01/C8:          	; CHECK ARG COUNT
01/C8: 8000     	LOAD	A,[ARGC]
01/C9: 7001     	SUBI	A,1
01/CA: F7F1     	BRNZ	ARGBAD
01/CC:          	
01/CB: FFF8     	JUMP	EXIT
01/CD:          
01/CC:          
01/CC:          	; BANK IS DONE, MOVE ON TO THE NEXT
01/CC:          BI	= BI+1
01/CC:          .TEXT
01/CC:          .BANK	BI
02/80:          CORE1_B	= BI
02/80:          
02/80:          .DATA
02/00:          .BANK	BD
01/00:          STR_B	= BD
01/00:          
01/00:          	; ERROR MESSAGES
01/00: 494E5641
       4C494420
       41524755
       4D454E54
       530A0D   .DEFL BYTE ERROR0	"INVALID ARGUMENTS",0X0A,0X0D,
01/13: 55534147
       453A2058
       4D4F4445
       4D205B2D
       53545D20
       46494C45
       0A0D00   			"USAGE: XMODEM [-ST] FILE",0X0A,0X0D,0
01/2E: 43414E27
       54204F50
       454E2046
       494C450A
       0D00     .DEFL BYTE ERROR1	"CAN'T OPEN FILE",0X0A,0X0D,0
01/40: 43414E27
       54204F50
       454E2046
       494C450A
       0D00     .DEFL BYTE ERROR2	"CAN'T OPEN FILE",0X0A,0X0D,0
01/52: 43414E27
       54204352
       45415445
       2046494C
       450A0D00 .DEFL BYTE ERROR3	"CAN'T CREATE FILE",0X0A,0X0D,0
01/66:          
01/66:          	; ZERO BANK STUFF
01/66:          .BANK	0
00/00:          .BSS
00/00:          
00/00:          	; COMMAND LINE ARGUMENTS
00/00: 00       .DEFL BYTE ARGC		0
00/01: 0000     .DEFL BYTE ARGV		0,0
00/03:          
00/03:          	; COMMAND LINE FLAGS
00/03: 00       .DEFL BYTE SFLAG	0
