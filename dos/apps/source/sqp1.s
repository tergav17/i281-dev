; SQP1.S
; AY-3-8910 SQT CHIPTUNE DRIVER
; GAVIN TERSTEEG, 2024
; SDMAY24-14

; AY-3-8910 IO ADDRESSES
MEGAIO	= 0XB0
AY0_ADR	= MEGAIO+0
AY1_ADR = MEGAIO+2
AY0_WR	= MEGAIO+1
AY1_WR	= MEGAIO+3
AY0_RD	= MEGAIO+0
AY1_rD	= MEGAIO+2

	; SQT PLAYBACK STATE
.BANK	BD
.DATA
SQP_B	= BD


	; START OF SQT PLAYBACK STACK
.ORG	0X7E
.DEFL BYTE SQSTACK	0,0

BD	= BD+1 

	; SQT FREQUENCY TABLE 0
.BANK	BD
.DATA
SQFR0_B	= BD

.DEFL BYTE SQFREQ0	0X0D, 0X0C, 0X0B, 0X0B, 0X0A, 0X0A, 0X09, 0X08,
			0X08, 0X07, 0X07, 0X07, 0X06, 0X06, 0X05, 0X05,
			0X05, 0X05, 0X04, 0X04, 0X04, 0X03, 0X03, 0X03,
			0X03, 0X03, 0X02, 0X02, 0X02, 0X02, 0X02, 0X02,
			0X02, 0X01, 0X01, 0X01, 0X01, 0X01, 0X01, 0X01,
			0X01, 0X01, 0X01, 0X01, 0X01, 0X00, 0X00, 0X00,
			0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00,
			0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00,
			0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00,
			0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 
			0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00,
			0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00, 0X00

BD	= BD+1

	; SQT FREQUENCY TABLE 1
.BANK	BD
.DATA
SQFR1_B	= BD

.DEFL BYTE SQFREQ1	0X5D, 0X9C, 0XE7, 0X3C, 0X9B, 0X02, 0X73, 0XEB,
			0X6B, 0XF2, 0X80, 0X14, 0XAE, 0X4E, 0XF4, 0X9E,
			0X4F, 0X01, 0XB9, 0X75, 0X35, 0XF9, 0XC0, 0X8A,
			0X57, 0X27, 0XFA, 0XCF, 0XA7, 0X81, 0X5D, 0X3B,
			0X1B, 0XFC, 0XE0, 0XC5, 0XAC, 0X94, 0X7D, 0X68,
			0X53, 0X40, 0X2E, 0X1D, 0X0D, 0XFE, 0XF0, 0XE2,
			0XD6, 0XCA, 0XBE, 0XB4, 0XAA, 0XA0, 0X97, 0X8F,
			0X87, 0X7F, 0X78, 0X71, 0X6B, 0X65, 0X5F, 0X5A,
			0X55, 0X50, 0X4C, 0X47, 0X43, 0X40, 0X3C, 0X39,
			0X35, 0X32, 0X30, 0X2D, 0X2A, 0X28, 0X26, 0X24,
			0X22, 0X20, 0X1E, 0X1C, 0X1B, 0X19, 0X18, 0X16,
			0X15, 0X14, 0X13, 0X12, 0X11, 0X10, 0X0F, 0X0E

BD	= BD+1 

BI	= BI+1
.TEXT
.BANK	BI
SQT0_B	= BI

	; INITALIZE THE SQT PLAYER
SQINIT:JUMP	IRET

	; UPDATE THE SQT PLAYER
	; SHOULD BE CALLED 50 TIMES PER SECOND
SQPLAY:JUMP	IRET

	; RESET THE SQT PLAYER
	; AY-3-8910 CHIPS WILL BE MUTED
SQRSET:JUMP	IRET

	; WAIT FOR THE 50 HZ TIMER
SQWAIT:JUMP	IRET