; AUXTTY.S
; AUXILIARY SERIAL DEVICE DRIVER
; GAVIN TERSTEEG, 2024
; SDMAY24-14

.BANK BI
AUX0_B	= BI
.TEXT

	; AUXILIARY SERIAL INIT
	; ASSUMES WORK BANK IS SELECTED
	; USES:
AUXINIT:JUMP	AUXDONE

	; SENDS A BYTE TO THE AUXILIARY SERIAL DEVICE
	; ASSUMES WORK BANK IS SELECTED
	; A = BYTE TO SEND
	; USES: 
AUXPUTB:JUMP	AUXDONE

	; WAIT FOR A BYTE TO BE RECIEVED BY THE AUXILIARY SERIAL DEVICE
	; IF AUXSTAT RETURN 0XFF, THE RETURN WILL BE INSTANT
	; ASSUMES WORK BANK IS SELECTED
	; BYTE RETURNED IN A
	; USES:
AUXGETB:JUMP	AUXDONE

	; POLL THE AUXILIARY SERIAL DEVICE TO SEE IF THERE IS A 
	; BYTE WAITING
	; ASSUMES WORK BANK IS SELECTED
	; RETURNS A=0XFF IF THERE IS A BYTE, OTHERWISE A=0X00
AUXSTAT:LOADI	A,0

	; INTERNAL TTY FUNCTION TO RESET TO WORK BANK AND RETURN
AUXDONE:LOADI	C,WORK_B
	STORE	[DBANK],C
	JUMP	IRET

	; BANK IS DONE, MOVE ON TO THE NEXT
BI	= BI-1
